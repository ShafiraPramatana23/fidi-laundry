package com.fidilaundry.app.ui.profileimport android.os.Bundleimport androidx.lifecycle.Observerimport com.fidilaundry.app.Rimport com.fidilaundry.app.basearch.viewmodel.ProfileViewModelimport com.fidilaundry.app.databinding.ActivityChangeProfileBindingimport com.fidilaundry.app.model.response.*import com.fidilaundry.app.ui.base.BaseActivityimport com.fidilaundry.app.util.LoadingDialogimport com.fidilaundry.app.util.fdialog.ErrorMessageimport com.fidilaundry.app.util.fdialog.FGCallbackimport com.fidilaundry.app.util.fdialog.SuccessMessageimport com.fidilaundry.app.util.setSafeOnClickListenerimport org.koin.androidx.viewmodel.ext.android.getViewModelclass ChangeProfileActivity : BaseActivity() {    lateinit var loadingDialog: LoadingDialog    private val binding: ActivityChangeProfileBinding by binding(R.layout.activity_change_profile)    private val viewModel: ProfileViewModel by lazy {        getViewModel(ProfileViewModel::class)    }    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        binding.apply {            lifecycleOwner = this@ChangeProfileActivity            this.vm = viewModel        }        loadingDialog = LoadingDialog()        initViewModel()        binding.ivBack.setSafeOnClickListener {            finish()        }        binding.btnSubmit.setSafeOnClickListener {            viewModel.userId.value = paperPref.getDataProfile()?.id!!            viewModel.changeProfile()        }    }    private fun initViewModel() {        viewModel.changeProfileResponse.observe(this, Observer {            handleWhenChangeSuccess(it)        })        viewModel.showProgressLiveData.observe(this, Observer { showLoading ->            if (showLoading) {                if(loadingDialog != null){                    if(!loadingDialog.isShowLoad())                        loadingDialog.showProgressDialog(this, "Mohon tunggu…")                    else {                        loadingDialog.dismissDialog()                        loadingDialog.showProgressDialog(this, "Mohon tunggu…")                    }                }            } else {                loadingDialog.dismissDialog()            }        })        viewModel.showError.observe(this, Observer { showError ->            ErrorMessage(this, "", showError)        })    }    private fun handleWhenChangeSuccess(it: BaseObjResponse?) {        SuccessMessage(this, "", "Ubah profil berhasil!", object : FGCallback {            override fun onCallback() {                finish()            }        })    }}